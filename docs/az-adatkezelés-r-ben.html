<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>3 Az adatkezelés R-ben | Szövegbányászat és mesterséges intelligencia R-ben</title>
  <meta name="description" content="3 Az adatkezelés R-ben | Szövegbányászat és mesterséges intelligencia R-ben" />
  <meta name="generator" content="bookdown 0.21 and GitBook 2.6.7" />

  <meta property="og:title" content="3 Az adatkezelés R-ben | Szövegbányászat és mesterséges intelligencia R-ben" />
  <meta property="og:type" content="book" />
  
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="3 Az adatkezelés R-ben | Szövegbányászat és mesterséges intelligencia R-ben" />
  
  
  

<meta name="author" content="Sebők Miklós, Ring Orsolya" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="a-kvantitatív-szövegelemzés-és-szövegbányászat-alapfogalmai.html"/>
<link rel="next" href="leíró-statisztika-szózsák-és-szóeloszlások.html"/>
<script src="libs/header-attrs-2.6/header-attrs.js"></script>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<script src="libs/htmlwidgets-1.5.3/htmlwidgets.js"></script>
<link href="libs/str_view-0.1.0/str_view.css" rel="stylesheet" />
<script src="libs/str_view-binding-1.4.0/str_view.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Bevezetés</a></li>
<li class="chapter" data-level="2" data-path="a-kvantitatív-szövegelemzés-és-szövegbányászat-alapfogalmai.html"><a href="a-kvantitatív-szövegelemzés-és-szövegbányászat-alapfogalmai.html"><i class="fa fa-check"></i><b>2</b> A kvantitatív szövegelemzés és szövegbányászat alapfogalmai</a></li>
<li class="chapter" data-level="3" data-path="az-adatkezelés-r-ben.html"><a href="az-adatkezelés-r-ben.html"><i class="fa fa-check"></i><b>3</b> Az adatkezelés R-ben</a>
<ul>
<li class="chapter" data-level="3.1" data-path="az-adatkezelés-r-ben.html"><a href="az-adatkezelés-r-ben.html#adatok-importálása-és-exportálása"><i class="fa fa-check"></i><b>3.1</b> Adatok importálása és exportálása</a>
<ul>
<li class="chapter" data-level="3.1.1" data-path="az-adatkezelés-r-ben.html"><a href="az-adatkezelés-r-ben.html#szöveges-dokumentumok-importálása"><i class="fa fa-check"></i><b>3.1.1</b> Szöveges dokumentumok importálása</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="az-adatkezelés-r-ben.html"><a href="az-adatkezelés-r-ben.html#adatok-exportálása"><i class="fa fa-check"></i><b>3.2</b> Adatok exportálása</a></li>
<li class="chapter" data-level="3.3" data-path="az-adatkezelés-r-ben.html"><a href="az-adatkezelés-r-ben.html#a-pipe-operátor"><i class="fa fa-check"></i><b>3.3</b> A pipe operátor</a></li>
<li class="chapter" data-level="3.4" data-path="az-adatkezelés-r-ben.html"><a href="az-adatkezelés-r-ben.html#muveletek-a-date-framekkel"><i class="fa fa-check"></i><b>3.4</b> Muveletek a date framekkel</a>
<ul>
<li class="chapter" data-level="3.4.1" data-path="az-adatkezelés-r-ben.html"><a href="az-adatkezelés-r-ben.html#megfigyelések-szűrése-filter"><i class="fa fa-check"></i><b>3.4.1</b> Megfigyelések szűrése: <code>filter()</code></a></li>
<li class="chapter" data-level="3.4.2" data-path="az-adatkezelés-r-ben.html"><a href="az-adatkezelés-r-ben.html#változók-kiválogatása-select"><i class="fa fa-check"></i><b>3.4.2</b> Változók kiválogatása: <code>select()</code></a></li>
<li class="chapter" data-level="3.4.3" data-path="az-adatkezelés-r-ben.html"><a href="az-adatkezelés-r-ben.html#új-változók-létrehozása-mutate"><i class="fa fa-check"></i><b>3.4.3</b> Új változók létrehozása: <code>mutate()</code></a></li>
<li class="chapter" data-level="3.4.4" data-path="az-adatkezelés-r-ben.html"><a href="az-adatkezelés-r-ben.html#csoportonkénti-statisztikák-group_by-és-summarize"><i class="fa fa-check"></i><b>3.4.4</b> Csoportonkénti statisztikák: <code>group_by()</code> és <code>summarize()</code></a></li>
</ul></li>
<li class="chapter" data-level="3.5" data-path="az-adatkezelés-r-ben.html"><a href="az-adatkezelés-r-ben.html#munka-karakter-vektorokkaladatkezeles-4"><i class="fa fa-check"></i><b>3.5</b> Munka karakter vektorokkal</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="leíró-statisztika-szózsák-és-szóeloszlások.html"><a href="leíró-statisztika-szózsák-és-szóeloszlások.html"><i class="fa fa-check"></i><b>4</b> Leíró statisztika: szózsák és szóeloszlások</a></li>
<li class="chapter" data-level="5" data-path="a-szövegek-reprezentálása-a-vektortérben.html"><a href="a-szövegek-reprezentálása-a-vektortérben.html"><i class="fa fa-check"></i><b>5</b> A szövegek reprezentálása a vektortérben</a></li>
<li class="chapter" data-level="6" data-path="a-korpuszépítés-problémái-és-a-szövegel-készítés.html"><a href="a-korpuszépítés-problémái-és-a-szövegel-készítés.html"><i class="fa fa-check"></i><b>6</b> A korpuszépítés problémái és a szövegelőkészítés</a></li>
<li class="chapter" data-level="7" data-path="szótáralapú-elemzések-érzelem-elemzés.html"><a href="szótáralapú-elemzések-érzelem-elemzés.html"><i class="fa fa-check"></i><b>7</b> Szótáralapú elemzések, érzelem-elemzés</a></li>
<li class="chapter" data-level="8" data-path="klaszterelemzés-és-topic-modellezés.html"><a href="klaszterelemzés-és-topic-modellezés.html"><i class="fa fa-check"></i><b>8</b> Klaszterelemzés és topic modellezés</a></li>
<li class="chapter" data-level="9" data-path="szóbeágyazások.html"><a href="szóbeágyazások.html"><i class="fa fa-check"></i><b>9</b> Szóbeágyazások</a></li>
<li class="chapter" data-level="10" data-path="szövegösszehasonlítás.html"><a href="szövegösszehasonlítás.html"><i class="fa fa-check"></i><b>10</b> Szövegösszehasonlítás</a></li>
<li class="chapter" data-level="11" data-path="természetes-nyelv-feldolgozás-nlp.html"><a href="természetes-nyelv-feldolgozás-nlp.html"><i class="fa fa-check"></i><b>11</b> Természetes-nyelv feldolgozás (NLP)</a></li>
<li class="chapter" data-level="12" data-path="osztályozás-és-felügyelt-tanulás.html"><a href="osztályozás-és-felügyelt-tanulás.html"><i class="fa fa-check"></i><b>12</b> Osztályozás és felügyelt tanulás</a></li>
<li class="chapter" data-level="13" data-path="függelék.html"><a href="függelék.html"><i class="fa fa-check"></i><b>13</b> Függelék</a>
<ul>
<li class="chapter" data-level="13.1" data-path="függelék.html"><a href="függelék.html#az-r-és-az-rstudio-használata"><i class="fa fa-check"></i><b>13.1</b> Az R és az RStudio használata</a>
<ul>
<li class="chapter" data-level="13.1.1" data-path="függelék.html"><a href="függelék.html#az-rstudio-kezdőfelülete"><i class="fa fa-check"></i><b>13.1.1</b> Az RStudio kezdőfelülete</a></li>
<li class="chapter" data-level="13.1.2" data-path="függelék.html"><a href="függelék.html#projektmunka"><i class="fa fa-check"></i><b>13.1.2</b> Projekt alapú munka</a></li>
<li class="chapter" data-level="13.1.3" data-path="függelék.html"><a href="függelék.html#scriptek-szerkesztése-függvények-használata"><i class="fa fa-check"></i><b>13.1.3</b> Scriptek szerkesztése, függvények használata</a></li>
<li class="chapter" data-level="13.1.4" data-path="függelék.html"><a href="függelék.html#packages"><i class="fa fa-check"></i><b>13.1.4</b> R csomagok</a></li>
<li class="chapter" data-level="13.1.5" data-path="függelék.html"><a href="függelék.html#objektumok-tárolása-értékadás"><i class="fa fa-check"></i><b>13.1.5</b> Objektumok tárolása, értékadás</a></li>
<li class="chapter" data-level="13.1.6" data-path="függelék.html"><a href="függelék.html#vektorok"><i class="fa fa-check"></i><b>13.1.6</b> Vektorok</a></li>
<li class="chapter" data-level="13.1.7" data-path="függelék.html"><a href="függelék.html#faktorok"><i class="fa fa-check"></i><b>13.1.7</b> Faktorok</a></li>
<li class="chapter" data-level="13.1.8" data-path="függelék.html"><a href="függelék.html#data-frame"><i class="fa fa-check"></i><b>13.1.8</b> Data frame</a></li>
</ul></li>
<li class="chapter" data-level="13.2" data-path="függelék.html"><a href="függelék.html#vizualizáció"><i class="fa fa-check"></i><b>13.2</b> Vizualizáció</a></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Szövegbányászat és mesterséges intelligencia R-ben</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="az-adatkezelés-r-ben" class="section level1" number="3">
<h1><span class="header-section-number">3</span> Az adatkezelés R-ben</h1>
<div id="adatok-importálása-és-exportálása" class="section level2" number="3.1">
<h2><span class="header-section-number">3.1</span> Adatok importálása és exportálása</h2>
<p>Az adatok importálására az R alapfüggvénye mellett több package is megoldást kínál. Ezek közül a könyv írásakor a legnépszerűbbek a <code>readr</code> és a <code>rio</code> csomagok. Az egyszerűség kedvéért mi az alap <code>read.csv()</code> függvényt fogjuk használni. Amennyiben kihasználjuk az RStudio projekt opcióját (lásd a <a href="függelék.html#projektmunka">Függelékben</a>) akkor elegendő csak az elérni kívánt adatok relativ elérési útját megadni (relative path). Ideális esetben az adataink egy csv fileban vannak (comma separated values), ahol az egyes értékeket vesszők (vagy egyéb speciális karakter) választják el. Ez esetben a <code>read.csv</code> függvényt használjuk. A beolvasásnál egyből el is tároljuk az adatokat egy objektumban. A <code>sep =</code> opcióval tudjuk a szeparátor karaktert beállítani, mert előfordulhat hogy vessző helyett pontosvessző tagolja az adatainkat.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="az-adatkezelés-r-ben.html#cb1-1" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">&quot;data/adatfile.csv&quot;</span>, <span class="at">sep =</span> <span class="st">&quot;,&quot;</span>)</span></code></pre></div>
<p>Az R képes linkről letölteni fileokat, elég megadnunk egy működő elérési útvonalat.</p>
<p><strong>placeholder link, cserelni majd mukodore</strong></p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="az-adatkezelés-r-ben.html#cb2-1" aria-hidden="true" tabindex="-1"></a>df_online <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">&quot;https://www.qta.tk.mta.hu/adatok/adatfile.csv&quot;</span>)</span></code></pre></div>
<p>Az R package ökoszisztémája kellően változatos ahhoz, hogy gyakorlatilag bármilyen inputtal meg tudjon bírkózni. Az Excel fileokat a <code>readxl</code> csomagot használva tudjuk betölteni (a csomagok installálásával kapcsolatban lásd a <a href="függelék.html#packages">Függeléket</a>), a <code>read_excel()</code>-t használva. A leggyakoribb statisztikai programok formátumait pedig a <code>haven</code> csomag tudja kezelni (például Stata, Spss, SAS). A szintaxis itt is hasonló: <code>read_stata</code>, <code>read_spss</code>, <code>read_sas</code>.</p>
<div id="szöveges-dokumentumok-importálása" class="section level3" number="3.1.1">
<h3><span class="header-section-number">3.1.1</span> Szöveges dokumentumok importálása</h3>
<p>A nagy mennyiségű szöveges dokumentum (a legyakrabban előforduló kiterjesztések: <code>.txt</code>, <code>.doc</code>, <code>.pdf</code>, <code>.json</code>, <code>.csv</code>, <code>.xml</code>, <code>.rtf</code>, <code>.odt</code>) betöltésére a legalkalmasabb a <code>readtext</code> package. Az alábbi példa azt mutatja be, hogy hogyan tudunk beolvasni egy adott mappából az összes .txt kiterjesztésű file-t, anélkül hogy bármilyen loop-ot kellene írnunk, vagy egyenként megadni a file-ok neveit. A <code>*</code> karakter az azt jelenti ebben a környezetben, hogy bármilyen fájl, ami .txt-re végződik. Amennyiben a fájlok nevei tartalmaznak valamilyen meta adatot tartalmaznak, akkor ezt be tudjuk allítani a betöltés során. Ilyen meta adat lehet például egy parlamenti felszólalásnál a felszólaló neve és a beszéd ideje és párttagsága (például: <code>kovacsjanos_1994_fkgp.txt</code>).</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="az-adatkezelés-r-ben.html#cb3-1" aria-hidden="true" tabindex="-1"></a>df_text <span class="ot">&lt;-</span> <span class="fu">readtext</span>(</span>
<span id="cb3-2"><a href="az-adatkezelés-r-ben.html#cb3-2" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot;data/*.txt&quot;</span>, </span>
<span id="cb3-3"><a href="az-adatkezelés-r-ben.html#cb3-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">docvarsfrom =</span> <span class="st">&quot;filenames&quot;</span>, </span>
<span id="cb3-4"><a href="az-adatkezelés-r-ben.html#cb3-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">dvsep =</span> <span class="st">&quot;_&quot;</span>,</span>
<span id="cb3-5"><a href="az-adatkezelés-r-ben.html#cb3-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">docvarnames =</span> <span class="fu">c</span>(<span class="st">&quot;nev&quot;</span>, <span class="st">&quot;ev&quot;</span>, <span class="st">&quot;part&quot;</span>)</span>
<span id="cb3-6"><a href="az-adatkezelés-r-ben.html#cb3-6" aria-hidden="true" tabindex="-1"></a>  )</span></code></pre></div>
</div>
</div>
<div id="adatok-exportálása" class="section level2" number="3.2">
<h2><span class="header-section-number">3.2</span> Adatok exportálása</h2>
<p>Az adatainkat R-ből a <code>write.csv()</code>-vel exportálhatjuk a kívánt helyre, <code>.csv</code> formátumban. Az R rendelkezik saját, .Rds és .Rda kiterjesztésű, tömörített fájlformátummal. Mivel ezeket csak az R-ben nyithatjuk meg, érdemes a köztes, hosszadalmas számítást igénylő lépések elmentésére használni, a <code>saveRDS()</code> és a <code>save()</code> parancsokkal. Az <code>openxlsx</code> csomaggal <code>.xls</code> és <code>.xlsx</code> Excel formátumokba is tudunk exportálni, hogyha szükséges.</p>
</div>
<div id="a-pipe-operátor" class="section level2" number="3.3">
<h2><span class="header-section-number">3.3</span> A pipe operátor</h2>
<p>Az úgynevezett <em>pipe</em> operátor alapjaiban határozta meg a modern R fejlődését és a népszerű package ökoszisztéma, a <em>tidyverse</em>, egyik alapköve. Úgy gondoljuk, hogy a <em>tidyverse</em> és a <em>pipe</em> egyszerűbbé teszi elsajátítani az R használatát, ezért mi is erre helyezzük a hangsúlyt.<a href="#fn1" class="footnote-ref" id="fnref1"><sup>1</sup></a> Vizuálisan a pipe operátor így néz ki: <code>%&gt;%</code> és arra szolgál hogy a kódban több egymáshoz kapcsolódó műveletet egybefűzzűnk.<a href="#fn2" class="footnote-ref" id="fnref2"><sup>2</sup></a> Technikailag a pipe a bal oldali elemet adja meg a jobb oldali függvény első argumentumának. A lenti példa ugyanazt a folyamatot írja le, az alap R (<em>base R</em>) illetve a pipe használatával.<a href="#fn3" class="footnote-ref" id="fnref3"><sup>3</sup></a> Miközben a kódot olvassuk érdemes a pipe-ot “<em>és aztán</em>”-nak fordítani.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="az-adatkezelés-r-ben.html#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="fu">reggeli</span>(<span class="fu">oltozkodes</span>(<span class="fu">felkeles</span>(<span class="fu">ebredes</span>(en, <span class="at">idopont =</span> <span class="st">&quot;8:00&quot;</span>), <span class="at">oldal =</span> <span class="st">&quot;jobb&quot;</span>), <span class="at">nadrag =</span> <span class="cn">TRUE</span>, <span class="at">ing =</span> <span class="cn">TRUE</span>))</span>
<span id="cb4-2"><a href="az-adatkezelés-r-ben.html#cb4-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-3"><a href="az-adatkezelés-r-ben.html#cb4-3" aria-hidden="true" tabindex="-1"></a>en <span class="sc">%&gt;%</span> </span>
<span id="cb4-4"><a href="az-adatkezelés-r-ben.html#cb4-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ebredes</span>(<span class="at">idopont =</span> <span class="st">&quot;8:00&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb4-5"><a href="az-adatkezelés-r-ben.html#cb4-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">felkeles</span>(<span class="at">oldal =</span> <span class="st">&quot;jobb&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb4-6"><a href="az-adatkezelés-r-ben.html#cb4-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">oltozkodes</span>(<span class="at">nadrag =</span> <span class="cn">TRUE</span>, <span class="at">ing =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb4-7"><a href="az-adatkezelés-r-ben.html#cb4-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">reggeli</span>()</span></code></pre></div>
<p>A fenti példa is jól mutatja, hogy a pipe a bal oldali elemet fogja a jobb oldali függvény első elemének berakni. A fejezet további részeiben még bőven fogunk gyakorlati példát találni a használatára. A fejezetben bemutatott példák az alkalmazásoknak csak egy relatíve szűk körét mutatják be, ezért érdemes átolvasni a csomagokhoz tartozó dokumentációt, illetve ha van, akkor a működést demonstráló bemutató oldalakat is.</p>
</div>
<div id="muveletek-a-date-framekkel" class="section level2" number="3.4">
<h2><span class="header-section-number">3.4</span> Muveletek a date framekkel</h2>
<p>A data frame az egyik leghasznosabb és leggyakrabban használt adat tárolási mód az R-ben (a részletesebb leírás a <a href="függelék.html#data-frame">Függelékben</a> található) és ebben az alfejezetben azt mutatjuk be a <code>dplyr</code> és <code>gapminder</code> csomagok segíségével, hogy hogyan lehet hatékonyan dolgozni velük. A <code>dplyr</code> az egyik legnépszerűbb R csomag, a <em>tidyverse</em> része. A <code>gapminder</code> csomag pedig a példa adatbázisunkat tartalmazza, amiben a világ országainak különböző gazdasági és társadalmi mutatói vannak.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="az-adatkezelés-r-ben.html#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb5-2"><a href="az-adatkezelés-r-ben.html#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gapminder)</span></code></pre></div>
<div id="megfigyelések-szűrése-filter" class="section level3" number="3.4.1">
<h3><span class="header-section-number">3.4.1</span> Megfigyelések szűrése: <code>filter()</code></h3>
<p>A sorok (megfigyelések) szűréséhez a <code>dplyr</code> csomag <code>filter()</code> parancsát használva lehetőségünk van arra hogy egy vagy több kritérium alapján szűkítsük az adatbázisunkat. A lenti példában azokat megfigyeléseket tartjuk meg, ahol az év 1962 és a várható élettartam nagyobb mint 72 év.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="az-adatkezelés-r-ben.html#cb6-1" aria-hidden="true" tabindex="-1"></a>gapminder <span class="sc">%&gt;%</span></span>
<span id="cb6-2"><a href="az-adatkezelés-r-ben.html#cb6-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(year <span class="sc">==</span> <span class="dv">1962</span>, lifeExp <span class="sc">&gt;</span> <span class="dv">72</span>)</span></code></pre></div>
<pre><code>## # A tibble: 5 x 6
##   country     continent  year lifeExp      pop gdpPercap
##   &lt;fct&gt;       &lt;fct&gt;     &lt;int&gt;   &lt;dbl&gt;    &lt;int&gt;     &lt;dbl&gt;
## 1 Denmark     Europe     1962    72.4  4646899    13583.
## 2 Iceland     Europe     1962    73.7   182053    10350.
## 3 Netherlands Europe     1962    73.2 11805689    12791.
## 4 Norway      Europe     1962    73.5  3638919    13450.
## 5 Sweden      Europe     1962    73.4  7561588    12329.</code></pre>
<p>De ugyanígy leválogathatjuk a data frame-ből az adatokat akkor is hogyha egy karakter változó alapján szeretnénk szűrni.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="az-adatkezelés-r-ben.html#cb8-1" aria-hidden="true" tabindex="-1"></a>gapminder <span class="sc">%&gt;%</span></span>
<span id="cb8-2"><a href="az-adatkezelés-r-ben.html#cb8-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(country <span class="sc">==</span> <span class="st">&quot;Sweden&quot;</span>, year <span class="sc">&gt;</span> <span class="dv">1990</span>)</span></code></pre></div>
<pre><code>## # A tibble: 4 x 6
##   country continent  year lifeExp     pop gdpPercap
##   &lt;fct&gt;   &lt;fct&gt;     &lt;int&gt;   &lt;dbl&gt;   &lt;int&gt;     &lt;dbl&gt;
## 1 Sweden  Europe     1992    78.2 8718867    23880.
## 2 Sweden  Europe     1997    79.4 8897619    25267.
## 3 Sweden  Europe     2002    80.0 8954175    29342.
## 4 Sweden  Europe     2007    80.9 9031088    33860.</code></pre>
<p>Itt tehát a data frame azon sorait szeretnénk látni, ahol az ország megegyezik a „Sweden" karakterlánccal az év pedig nagyobb, mint 1990.</p>
</div>
<div id="változók-kiválogatása-select" class="section level3" number="3.4.2">
<h3><span class="header-section-number">3.4.2</span> Változók kiválogatása: <code>select()</code></h3>
<p>A <code>select()</code> függvény segítségével válogathatunk oszlopokat a data frame-ből. A változók kiválasztására több megoldás is van. A <code>dplyr</code> csomag tartalmaz apróbb kisegítő függvényeket, amik megkönnyítik a nagy adatbázisok esetén a változók kiválogatását a nevük alapján. Ezek a függvények a <code>contains()</code>, <code>starts_with()</code>, <code>ends_with()</code>, <code>matches()</code> és beszédesen arra szolgálnak hogy bizonyos nevű változókat ne kelljen egyenként felsorolni. A <code>select()</code>-en belüli változó sorrend egyben az eredmény data frame változó sorrendjet is megadja. A negatív kiválasztás is lehetséges, ebben az esetben egy <code>-</code> kell tennünk a nemkívánt változó(k) elé (pl.: <code>select(df, year, country, -continent</code>).</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="az-adatkezelés-r-ben.html#cb10-1" aria-hidden="true" tabindex="-1"></a>gapminder <span class="sc">%&gt;%</span> </span>
<span id="cb10-2"><a href="az-adatkezelés-r-ben.html#cb10-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="fu">contains</span>(<span class="st">&quot;ea&quot;</span>), <span class="fu">starts_with</span>(<span class="st">&quot;co&quot;</span>), pop)</span></code></pre></div>
<pre><code>## # A tibble: 1,704 x 4
##     year country     continent      pop
##    &lt;int&gt; &lt;fct&gt;       &lt;fct&gt;        &lt;int&gt;
##  1  1952 Afghanistan Asia       8425333
##  2  1957 Afghanistan Asia       9240934
##  3  1962 Afghanistan Asia      10267083
##  4  1967 Afghanistan Asia      11537966
##  5  1972 Afghanistan Asia      13079460
##  6  1977 Afghanistan Asia      14880372
##  7  1982 Afghanistan Asia      12881816
##  8  1987 Afghanistan Asia      13867957
##  9  1992 Afghanistan Asia      16317921
## 10  1997 Afghanistan Asia      22227415
## # ... with 1,694 more rows</code></pre>
</div>
<div id="új-változók-létrehozása-mutate" class="section level3" number="3.4.3">
<h3><span class="header-section-number">3.4.3</span> Új változók létrehozása: <code>mutate()</code></h3>
<p>Az elemzési munkafolyamat elkerülhetetlen része hogy új változókat hozzunk létre, vagy a meglévőket módosítsuk. Ezt a <code>mutate()</code>-el tehetjuk meg, ahol a szintaxis a következő: <code>mutate(data frame, uj valtozo = ertekek)</code>. Példaként kiszámoljuk a Svéd GDP-t (milliárd dollárban) 1992-től kezdve. A <code>mutate()</code> alkalmazásával részletesebben is foglalkozunk a szövegek előkészítésével foglalkozó fejezetben.</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="az-adatkezelés-r-ben.html#cb12-1" aria-hidden="true" tabindex="-1"></a>gapminder <span class="sc">%&gt;%</span> </span>
<span id="cb12-2"><a href="az-adatkezelés-r-ben.html#cb12-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(country <span class="sc">==</span> <span class="st">&quot;Sweden&quot;</span>, year <span class="sc">&gt;=</span> <span class="dv">1992</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb12-3"><a href="az-adatkezelés-r-ben.html#cb12-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">gdp =</span> (gdpPercap <span class="sc">*</span> pop) <span class="sc">/</span> <span class="dv">10</span><span class="sc">^</span><span class="dv">9</span>)</span></code></pre></div>
<pre><code>## # A tibble: 4 x 7
##   country continent  year lifeExp     pop gdpPercap   gdp
##   &lt;fct&gt;   &lt;fct&gt;     &lt;int&gt;   &lt;dbl&gt;   &lt;int&gt;     &lt;dbl&gt; &lt;dbl&gt;
## 1 Sweden  Europe     1992    78.2 8718867    23880.  208.
## 2 Sweden  Europe     1997    79.4 8897619    25267.  225.
## 3 Sweden  Europe     2002    80.0 8954175    29342.  263.
## 4 Sweden  Europe     2007    80.9 9031088    33860.  306.</code></pre>
</div>
<div id="csoportonkénti-statisztikák-group_by-és-summarize" class="section level3" number="3.4.4">
<h3><span class="header-section-number">3.4.4</span> Csoportonkénti statisztikák: <code>group_by()</code> és <code>summarize()</code></h3>
<p>Az adataink részletesebb és alaposabb megismerésében segítenek a különböző szintű leíró statisztikai adatok. A szintek megadására a <code>group_by()</code> használható, a csoportokon belüli számításokhoz pedig a <code>summarize()</code>. A lenti példa azt illusztrálja, hogyha kontinensenként csoportosítjuk a <code>gapminder</code> data framet, akkor a <code>summarise()</code> használatával megkaphatjuk a megfigyelések számát, illetve az átlagos per capita GDP-t. A <code>summarise()</code> a <code>mutate()</code> közeli rokona, hasonló szintaxissal és logikával használható. Ezt a függvény párost fogjuk majd használni a szöveges adataink leíró statisztikáinál is a 4. fejezetben.</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="az-adatkezelés-r-ben.html#cb14-1" aria-hidden="true" tabindex="-1"></a>gapminder <span class="sc">%&gt;%</span> </span>
<span id="cb14-2"><a href="az-adatkezelés-r-ben.html#cb14-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(continent) <span class="sc">%&gt;%</span> </span>
<span id="cb14-3"><a href="az-adatkezelés-r-ben.html#cb14-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">megfigyelesek =</span> <span class="fu">n</span>(), <span class="at">atlag_gdp =</span> <span class="fu">mean</span>(gdpPercap))</span></code></pre></div>
<pre><code>## `summarise()` ungrouping output (override with `.groups` argument)</code></pre>
<pre><code>## # A tibble: 5 x 3
##   continent megfigyelesek atlag_gdp
##   &lt;fct&gt;             &lt;int&gt;     &lt;dbl&gt;
## 1 Africa              624     2194.
## 2 Americas            300     7136.
## 3 Asia                396     7902.
## 4 Europe              360    14469.
## 5 Oceania              24    18622.</code></pre>
</div>
</div>
<div id="munka-karakter-vektorokkaladatkezeles-4" class="section level2" number="3.5">
<h2><span class="header-section-number">3.5</span> Munka karakter vektorokkal<a href="#fn4" class="footnote-ref" id="fnref4"><sup>4</sup></a></h2>
<p>A szöveges adatokkal (karakter stringekkel) való munka elkerülhetetlen velejárója hogy a felesleges szövegelemeket, karaktereket el kell távolítanunk ahhoz hogy az elemzésünk hatásfoka javuljon (erről részletesebben a 3. fejezetben lesz szó). Erre a célra a <code>stringr</code> csomagot fogjuk használni, kombinálva a korábban bemutatott <code>mutate()</code>-el. A <code>stringr</code> függvények az <code>str_</code> előtaggal kezdődnek és eléggé beszédes nevekkel rendelkeznek. Egy gyakran előforduló probléma, hogy extra szóközök maradnak a szövegben, vagy bizonyos szavakról, karakterkombinációkról tudjuk hogy nem kellenek az elemzésünkhoz. Ebben az esetben egy vagy több <em>regular expression</em> (regex) használatával tudjuk pontosan kijelölni hogy a karakter sornak melyik részét akarjuk módosítani. A legegyszerűbb formája a regexeknek, hogyha pontosan tudjuk milyen szöveget akarunk megtalálni. A kísérletezésre az <code>str_view()</code>-t használjuk, ami megjeleníti hogy a megadott regex mintánk pontosan mit jelöl.</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="az-adatkezelés-r-ben.html#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(stringr)</span></code></pre></div>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="az-adatkezelés-r-ben.html#cb18-1" aria-hidden="true" tabindex="-1"></a>szoveg <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&#39;gitar&#39;</span>, <span class="st">&#39;ukulele&#39;</span>, <span class="st">&#39;nagybogo&#39;</span>)</span>
<span id="cb18-2"><a href="az-adatkezelés-r-ben.html#cb18-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-3"><a href="az-adatkezelés-r-ben.html#cb18-3" aria-hidden="true" tabindex="-1"></a><span class="fu">str_view</span>(szoveg, <span class="at">pattern =</span> <span class="st">&quot;ar&quot;</span>)</span></code></pre></div>
<div id="htmlwidget-743f0a03e4f78b907d8c" style="width:960px;height:100%;" class="str_view html-widget"></div>
<script type="application/json" data-for="htmlwidget-743f0a03e4f78b907d8c">{"x":{"html":"<ul>\n  <li>git<span class='match'>ar<\/span><\/li>\n  <li>ukulele<\/li>\n  <li>nagybogo<\/li>\n<\/ul>"},"evals":[],"jsHooks":[]}</script>
<p>Az <em>anchor</em>-okkal azt lehet megadni, hogy a karakter string elején vagy végén szeretnénk egyezést találni. A string eleji anchor a <code>^</code>, a string végi pedig a <code>$</code>.</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="az-adatkezelés-r-ben.html#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="fu">str_view</span>(<span class="st">&quot;Dr. Doktor Dr.&quot;</span>, <span class="at">pattern =</span> <span class="st">&quot;^Dr.&quot;</span>)</span></code></pre></div>
<div id="htmlwidget-cf8cf9d9cf39a1883653" style="width:960px;height:100%;" class="str_view html-widget"></div>
<script type="application/json" data-for="htmlwidget-cf8cf9d9cf39a1883653">{"x":{"html":"<ul>\n  <li><span class='match'>Dr.<\/span> Doktor Dr.<\/li>\n<\/ul>"},"evals":[],"jsHooks":[]}</script>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="az-adatkezelés-r-ben.html#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="fu">str_view</span>(<span class="st">&quot;Dr. Doktor Dr.&quot;</span>, <span class="at">pattern =</span> <span class="st">&quot;Dr.$&quot;</span>)</span></code></pre></div>
<div id="htmlwidget-51ee7c9cc7582d0adda6" style="width:960px;height:100%;" class="str_view html-widget"></div>
<script type="application/json" data-for="htmlwidget-51ee7c9cc7582d0adda6">{"x":{"html":"<ul>\n  <li>Dr. Doktor <span class='match'>Dr.<\/span><\/li>\n<\/ul>"},"evals":[],"jsHooks":[]}</script>
<p>Egy másik jellemző probléma, hogy olyan speciális karaktert akarunk leírni a regex kifejezésünkkel, ami amúgy a regex szintaxisban használt. Ilyen eset például a <code>.</code>, ami mint írásjel sokszor csak zaj, ám a regex kotextusban a “bármilyen karakter” megfelelője.</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="az-adatkezelés-r-ben.html#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="fu">str_view</span>(<span class="st">&quot;Dr. Doktor Dr.&quot;</span>, <span class="at">pattern =</span> <span class="st">&quot;.k.&quot;</span>)</span></code></pre></div>
<div id="htmlwidget-ccbbf2f3a379836afc97" style="width:960px;height:100%;" class="str_view html-widget"></div>
<script type="application/json" data-for="htmlwidget-ccbbf2f3a379836afc97">{"x":{"html":"<ul>\n  <li>Dr. D<span class='match'>okt<\/span>or Dr.<\/li>\n<\/ul>"},"evals":[],"jsHooks":[]}</script>
<p>Ahhoz hogy magát az írásjelet jelöljük, a <code>\\</code> -t kell elé rakni.</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="az-adatkezelés-r-ben.html#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="fu">str_view</span>(<span class="st">&quot;Dr. Doktor Dr.&quot;</span>, <span class="at">pattern =</span> <span class="st">&quot;</span><span class="sc">\\</span><span class="st">.&quot;</span>)</span></code></pre></div>
<div id="htmlwidget-7feb8f210d2d0881ae9a" style="width:960px;height:100%;" class="str_view html-widget"></div>
<script type="application/json" data-for="htmlwidget-7feb8f210d2d0881ae9a">{"x":{"html":"<ul>\n  <li>Dr<span class='match'>.<\/span> Doktor Dr.<\/li>\n<\/ul>"},"evals":[],"jsHooks":[]}</script>
<p>Néhány hasznos regex kifejezés:</p>
<ul>
<li><code>[:digit:]</code> - számok (123)</li>
<li><code>[:alpha:]</code> - betűk (abc ABC)</li>
<li><code>[:lower:]</code> - kisbetűk (abc)</li>
<li><code>[:upper:]</code> - nagybetűk (ABC)</li>
<li><code>[:alnum:]</code> - betűk és számok (123 abc ABC)</li>
<li><code>[:punct:]</code> - központozás (<code>.!?\(){}</code>)</li>
<li><code>[:graph:]</code> - betűk, számok és központozás (123 abc ABC <code>.!?\(){}</code>)</li>
<li><code>[:space:]</code> - szóköz ( )</li>
<li><code>[:blank:]</code> - szóköz és tabulálás</li>
<li><code>*</code> - bármi</li>
</ul>

</div>
</div>
<div class="footnotes">
<hr />
<ol start="1">
<li id="fn1"><p>A <em>tidyverse</em> megközelítés miatt a kötetben szereplő R kód követi a “The tidyverse style guide” dokumentációt (<a href="https://style.tidyverse.org/" class="uri">https://style.tidyverse.org/</a>)<a href="az-adatkezelés-r-ben.html#fnref1" class="footnote-back">↩︎</a></p></li>
<li id="fn2"><p>Az RStudio-ban a pipe operátor billentyű kombinációja a <code>Ctrl + Shift + M</code><a href="az-adatkezelés-r-ben.html#fnref2" class="footnote-back">↩︎</a></p></li>
<li id="fn3"><p>Köszönjük Andrew Heissnek a kitűnő példát.<a href="az-adatkezelés-r-ben.html#fnref3" class="footnote-back">↩︎</a></p></li>
<li id="fn4"><p>A könyv terjedelme miatt ezt a témát itt csak bemutatni tudjuk, de minden részletre kiterjedően nem tudunk elmélyülni benne. Kíváló online anyagok találhatóak az RStudio GitHub tárhelyén (<a href="https://github.com/rstudio/cheatsheets/raw/master/strings.pdf" class="uri">https://github.com/rstudio/cheatsheets/raw/master/strings.pdf</a>), illetve <span class="citation">@wickham2016r</span> 14. fejezetében.<a href="az-adatkezelés-r-ben.html#fnref4" class="footnote-back">↩︎</a></p></li>
</ol>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="a-kvantitatív-szövegelemzés-és-szövegbányászat-alapfogalmai.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="leíró-statisztika-szózsák-és-szóeloszlások.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "subsection"
}
});
});
</script>

</body>

</html>
